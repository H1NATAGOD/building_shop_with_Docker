# Интернет-магазин строительных материалов

Веб-приложение для автоматизации процессов онлайн-продажи строительных материалов, управления каталогом товаров, заказами, клиентами и складом.

## Технологический стек

- **Backend**: Node.js, Express.js
- **База данных**: PostgreSQL
- **Frontend**: HTML5, CSS3, JavaScript (Vanilla)
- **Аутентификация**: JWT (JSON Web Tokens)
- **Безопасность**: bcryptjs, helmet, express-rate-limit

## Функциональность

### Для клиентов:
- Регистрация и авторизация
- Просмотр каталога товаров с фильтрацией
- Поиск товаров по названию, категории, производителю
- Добавление товаров в корзину
- Оформление заказов
- Просмотр истории заказов
- Управление профилем

### Для сотрудников:
- Управление каталогом товаров
- Обработка заказов
- Управление клиентами
- Аналитика продаж
- Складской учет

## Установка и запуск

### Предварительные требования

1. **Node.js** (версия 14 или выше)
2. **PostgreSQL** (версия 12 или выше)
3. **npm** или **yarn**

### Установка

1. Клонируйте репозиторий или скачайте архив проекта
2. Перейдите в директорию проекта:
   ```bash
   cd construction-materials-store
   ```

3. Установите зависимости:
   ```bash
   npm install
   ```

4. Создайте файл `.env` на основе `env.example`:
   ```bash
   cp env.example .env
   ```

5. Настройте переменные окружения в файле `.env`:
   ```env
   # Настройки базы данных
   DB_HOST=localhost
   DB_PORT=5432
   DB_NAME=construction_store
   DB_USER=postgres
   DB_PASSWORD=your_password

   # Настройки сервера
   PORT=3000
   NODE_ENV=development
   FRONTEND_URL=http://localhost:3001

   # JWT секретный ключ
   JWT_SECRET=your-super-secret-jwt-key-here

   # Настройки безопасности
   BCRYPT_ROUNDS=12
   ```

### Настройка базы данных

1. Создайте базу данных PostgreSQL:
   ```sql
   CREATE DATABASE construction_store;
   ```

2. Выполните SQL скрипт инициализации:
   ```bash
   psql -U postgres -d construction_store -f database/init.sql
   ```

   Или подключитесь к базе данных и выполните содержимое файла `database/init.sql`

### Запуск приложения

1. Запустите сервер в режиме разработки:
   ```bash
   npm run dev
   ```

   Или в продакшн режиме:
   ```bash
   npm start
   ```

2. Откройте браузер и перейдите по адресу:
   ```
   http://localhost:3000
   ```

## API Документация

### Аутентификация

#### POST /api/auth/register
Регистрация нового пользователя
```json
{
  "email": "user@example.com",
  "password": "password123",
  "firstName": "Иван",
  "lastName": "Петров",
  "phoneNumber": "+7-999-123-45-67"
}
```

#### POST /api/auth/login
Вход в систему
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

#### GET /api/auth/me
Получение информации о текущем пользователе (требует токен)

### Товары

#### GET /api/products
Получение списка товаров с фильтрацией
Параметры запроса:
- `page` - номер страницы (по умолчанию 1)
- `limit` - количество товаров на странице (по умолчанию 20)
- `search` - поиск по названию
- `category` - фильтр по категории
- `manufacturer` - фильтр по производителю
- `minPrice` - минимальная цена
- `maxPrice` - максимальная цена
- `inStock` - только товары в наличии

#### GET /api/products/:id
Получение товара по ID

#### POST /api/products
Создание нового товара (требует права сотрудника)

#### PUT /api/products/:id
Обновление товара (требует права сотрудника)

#### DELETE /api/products/:id
Удаление товара (требует права сотрудника)

### Заказы

#### POST /api/orders
Создание нового заказа
```json
{
  "items": [
    {
      "productId": 1,
      "quantity": 2
    }
  ]
}
```

#### GET /api/orders/my
Получение заказов текущего клиента

#### GET /api/orders/my/:id
Получение детальной информации о заказе клиента

#### PUT /api/orders/my/:id/cancel
Отмена заказа клиентом

### Клиенты

#### GET /api/clients/profile
Получение профиля текущего клиента

#### PUT /api/clients/profile
Обновление профиля клиента

## Структура проекта

```
construction-materials-store/
├── config/
│   └── database.js          # Конфигурация базы данных
├── database/
│   └── init.sql            # SQL скрипт инициализации
├── middleware/
│   ├── auth.js             # Middleware аутентификации
│   └── validation.js       # Middleware валидации
├── routes/
│   ├── auth.js             # Маршруты аутентификации
│   ├── products.js         # Маршруты товаров
│   ├── clients.js          # Маршруты клиентов
│   ├── orders.js           # Маршруты заказов
│   └── cart.js             # Маршруты корзины
├── public/
│   └── index.html          # Веб-интерфейс
├── app.js                  # Главный файл приложения
├── package.json            # Зависимости проекта
├── env.example             # Пример переменных окружения
└── README.md               # Документация
```

## Тестовые данные

После выполнения SQL скрипта инициализации в базе данных будут созданы:

- **Категории**: Краски и лаки, Инструменты, Сухие смеси, и др.
- **Производители**: Tikkurila, Bosch, Makita, и др.
- **Товары**: 14 тестовых товаров с различными характеристиками
- **Тестовые пользователи**:
  - Администратор: `admin@store.com` / `password123`
  - Клиент: `client@test.com` / `password123`

## Безопасность

- Пароли хешируются с помощью bcryptjs
- JWT токены для аутентификации
- Rate limiting для защиты от DDoS
- Валидация входных данных
- CORS настройки
- Helmet для безопасности HTTP заголовков

## Разработка

### Добавление новых функций

1. Создайте новые маршруты в папке `routes/`
2. Добавьте соответствующие middleware в `middleware/`
3. Обновите схему базы данных при необходимости
4. Добавьте валидацию данных
5. Обновите документацию

### Отладка

Для отладки используйте:
```bash
npm run dev
```

Это запустит сервер с автоматической перезагрузкой при изменении файлов.

## Лицензия

MIT License

## Поддержка

При возникновении проблем:
1. Проверьте логи сервера
2. Убедитесь, что база данных запущена и доступна
3. Проверьте настройки в файле `.env`
4. Убедитесь, что все зависимости установлены

## Планы развития

- [ ] Административная панель
- [ ] Система уведомлений
- [ ] Интеграция с платежными системами
- [ ] Мобильное приложение
- [ ] Расширенная аналитика
- [ ] Система скидок и промокодов
